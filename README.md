# NET8AutomatedReports

### Automated Reporting System in .NET 8  

---

## Overview

Automated report generator built with **.NET 8**, capable of executing SQL queries, exporting results to Excel, and sending them via email automatically.  
Designed for teams that require daily or weekly automated reporting through a reliable and configurable system.

---

## Features

- Executes parameterized SQL queries dynamically.
- Exports data to **Excel** with automatic formatting.
- Sends reports via **SMTP** with HTML email templates.
- Fully configurable via `config.json`.
- Modular structure for easy maintenance and extension.

---

## Technologies Used

- **C# / .NET 8 (WinExe)**
- **EPPlus** (Excel automation)
- **MailKit & MimeKit** (SMTP email handling)
- **Serilog** (logging)
- **Microsoft.Data.SqlClient** (database connection)
- **JSON Serialization / Configuration**
- **Regular Expressions / LINQ**

---

## Project Structure

```
NET8AutomatedReports/
â”‚
â”œâ”€â”€ Program.cs                  # Main entry point of the application
â”œâ”€â”€ Config.cs                   # Handles configuration loading and validation
â”œâ”€â”€ ExcelExporter.cs             # Exports DataTables to Excel files
â”œâ”€â”€ SqlRunner.cs                 # Executes SQL queries located in /Queries
â”œâ”€â”€ SmtpMailer.cs                # Manages email sending via SMTP
â”œâ”€â”€ Reflection.cs                # Handles reflection utilities
â”‚
â”œâ”€â”€ CarpetaFinalEjemplo/         # Example output folder
â”‚   â”œâ”€â”€ config.json              # Configuration file with email and SQL setup
â”‚   â”œâ”€â”€ mail.html                # HTML email body template
â”‚   â”œâ”€â”€ Subject.html             # Email subject template
â”‚   â”œâ”€â”€ Sign/                    # Folder containing email signature image
â”‚   â”‚   â””â”€â”€ icono.png
â”‚   â””â”€â”€ Queries/                 # SQL query files (1TituloQuery1.txt, etc.)
â”‚
â”œâ”€â”€ Properties/
â”‚   â””â”€â”€ AssemblyInfo.cs          # Assembly metadata
â”‚
â”œâ”€â”€ icono.ico                    # Application icon
â”œâ”€â”€ .gitignore                   # Ignored files and folders
â”œâ”€â”€ NET8AutomatedReports.csproj  # .NET project configuration
â””â”€â”€ NET8AutomatedReports.sln     # Visual Studio solution file

```

---

## Configuration

`config.json` example:
```json
{
  "SQLServer": "SERVER_NAME",
  "SQLDBName": "DATABASE_NAME",
  "SQLUsername": "USERNAME",
  "SQLPassword": "PASSWORD",
  "OutputPath": "C:\\Reports\\",
  "SMTPServer": "smtp.server.com",
  "SMTPPort": 587,
  "SMTPUsername": "example@email.com",
  "SMTPPassword": "password",
  "SMTPEncryptionMode": "StartTls",
  "Email": {
    "From": "reports@company.com",
    "To": "recipient@company.com",
    "Cc": "",
    "Bcc": ""
  },
  "ReportDate": "2025-01-01T00:00:00"
}
```

---

## SMTP Compatibility

SMTPPort	Common ports:
â€¢ 25 â€“ Default unencrypted (often blocked by ISPs)
â€¢ 465 â€“ Encrypted (SSL/TLS)
â€¢ 587 â€“ Encrypted (STARTTLS, recommended)
SMTPEncryptionMode	Supported values:
â€¢ "None" â€“ No encryption (only if required)
â€¢ "SSL" â€“ Uses implicit SSL (port 465)
â€¢ "StartTls" â€“ Uses STARTTLS (port 587, recommended)
â€¢ "Auto" â€“ Automatically detects the best mode
SMTPServer	The SMTP hostname, e.g. smtp.office365.com, smtp.gmail.com, mail.company.com
SMTPUsername / SMTPPassword	Credentials for authentication (if required).

_If SMTPEncryptionMode is set to "Auto", the system will attempt SSL/TLS first, then fallback to STARTTLS, and finally to unencrypted mode if necessary._
---

## Usage

1. Place your SQL queries in `/Queries` (use `{ReportDate}` as placeholder for filtering).
   - If the report date is not in the correct format, the application will automatically use the system date.
2. Run the compiled executable on CarpetaFinalEjemplo.
3. The application will:
   - Read configuration
   - Execute queries (Queries manage a rule, #Name, # will give the order on excel output, and name will be the row title)
   - Export results to Excel
   - Send the Excel file via email
   - Log every step in `script.log` if log is enabled on Config.json

---

## Example SQL Query

```sql
SELECT 
    columna1 AS Campo1,
    columna2 AS Campo2,
    columna3 AS Campo3
FROM [esquema1].[dbo].[tabla1]
WHERE CAST(columna4 AS DATE) = '{ReportDate}'
ORDER BY columna1 ASC;
```

---

## Mail Template

The default email body is stored in **`mail.html`**, allowing embedded images (e.g. company signature) using CID references:

```html
<p>Kind Regards,</p>
<img src="cid:CompanySignature" alt="Signature"><br>
<b>Company Name</b><br>
<p>This is an automated report generated by NET8AutomatedReports.</p>
```

---

## Logging 

All execution logs are written using **Serilog**:

- Console output (if enabled)
- Daily file log: `script.log`

Logs include:
- Configuration load time
- SQL execution duration
- Email delivery status
- Error handling and exceptions

---

## Recompile New Project or Modification

To rebuild and publish the application:

```bash
dotnet publish -c Release -r win-x64 --self-contained true /p:PublishSingleFile=true /p:IncludeNativeLibrariesForSelfExtract=true /p:PublishTrimmed=true
```
The compiled executable must be inside the /CarpetaFinalEjemplo folder.

---

## License

This project is distributed under the **MIT License**.  
You are free to use, modify, and distribute it with proper attribution.

---

> *Built with passion and automation â€” simplifying report management through technology.*

---

â­ **Developed by [Juan Diego PeÃ±a Mayorga](https://www.linkedin.com/in/jdpm97/)**  
ğŸ“ _BogotÃ¡, Colombia_  
_Focused on automation, AI and system integration._

[![LinkedIn](https://img.shields.io/badge/LinkedIn-Juan%20Diego%20PeÃ±a-blue?style=for-the-badge&logo=linkedin)](https://www.linkedin.com/in/jdpm97/)
[![GitHub](https://img.shields.io/badge/GitHub-JuanDiegoPenaMayorga-181717?style=for-the-badge&logo=github)](https://github.com/JuanDiegoPenaMayorga)
[![Email](https://img.shields.io/badge/Email-JuanDiegoPena%40hotmail.com-red?style=for-the-badge&logo=gmail)](mailto:JuanDiegoPena@hotmail.com)

